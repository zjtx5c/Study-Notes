## 推荐系统（精摘）

直接看这位作者整理的[笔记](https://zhuanlan.zhihu.com/p/678664853)更省力

### 概要

#### 01：推荐系统的基本概念

> 这节课以小红书为例，讲解推荐系统的基本概念，包括： 
>
> 用户行为：点击、点赞、收藏、转发
>
> 消费指标：点击率 (click rate)、交互率 (engagement rate) 
>
> 北极星指标：用户规模、消费、发布
>
> 实验流程：离线实验、AB测试、推全

* 北极星指标
  * 是线上指标不是离线指标

* 优质内容池是社交平台（比如小红书）的核心竞争力。

* 算法工程师的工作就是对模型特征策略系统做改进，提升各种**指标**
  * 流程：离线实验——小流量AB测试——全流量上线



#### 02：推荐系统链路

> 这节课以小红书为例讲解推荐系统的链路。链路包括召回、粗排、精排、重排。 
>
> 召回（retrieval）：快速从海量数据中取回几千个用户可能感兴趣的物品。
>
> 粗排：用小规模的模型的神经网络给召回的物品打分，然后做截断，选出分数最高的几百个物品。
>
> 精排：用大规模神经网络给粗排选中的几百个物品打分，可以做截断，也可以不做截断。
>
> 重排：对精排结果做多样性抽样，得到几十个物品，然后用规则调整物品的排序。

* 把排序分为粗排与精排是为了解决计算量过大的问题，这是从效率的角度考虑的
  * 粗排是小模型但是处理的数据量巨大
  * 精排处理的数据量小但是模型很复杂（用的特征更多）
  * 这种设计确实通过**分层处理**实现了效率与效果的权衡：粗排确保系统响应速度，精排保障推荐质量。实际应用中还需根据业务场景调整阶段划分和模型复杂度。
  * 重排其实是做多样性抽样。抽样有两个依据：1. 精排分数大小；2. 多样性；抽样结束后，用一定的规则来打散相似笔记；还要插入广告、运营推广等内容。（很复杂，数千行代码）
* 模型的输入包括**用户特征**、**物品特征**以及**统计特征**



#### 03：推荐系统的AB测试

> 推荐系统算法工程师的日常工作就是改进模型和策略，目标是提升推荐系统的业务指标。所有对模型和策略的改进，都需要经过线上 AB 测试，用实验数据来验证模型和策略是否有效。这节课介绍工业界AB测试的一些基本概念。 
>
> 1. 分层实验，同层互斥，不同层正交，这样可以同时开很多实验。 
> 2. Holdout 机制用于衡量整个部门的业务指标收益。 
> 3. 实验推全、反转实验的基本思想。

* 离线效果≠在线效果

  * 需做**小流量**的 A/B 测试，考察对线上指标的影响
  * A/B测试可以选取模型中的最优参数

* 随机分桶

  * 针对每个桶分别设计多个实验组（每个组中模型的参数不一样） + 对照组

* 分层实验

  * 同层互斥、不同层正交
  * 理解**互斥与正交**，这样能提高效率

* Holdout 机制

  * 用来观察业绩
  * 比如保留 10% 的用户，完全不受实验影响，可以考察整个部门对业务指标的贡献

* 实验推全&反转实验

  * 新建一个推全层，与其他层正交。推全意味着扩大/覆盖到90%的流量上

  * 反转实验：在新的推全层上，保留一个小的反转桶，使用旧策略。长期观测新旧策略的 `diff`。

    

